<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Image Classification with Convolutional Neural Networks: Introduction to Deep Learning</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png"><link rel="manifest" href="favicons/incubator/site.webmanifest"><link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/01-introduction.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Image Classification with Convolutional Neural Networks
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Image Classification with Convolutional Neural Networks
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Image Classification with Convolutional Neural Networks
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 0%" class="percentage">
    0%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 0%" aria-valuenow="0" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/01-introduction.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        1. Introduction to Deep Learning
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#deep-learning-machine-learning-and-artificial-intelligence">Deep Learning, Machine Learning and Artificial Intelligence</a></li>
<li><a href="#what-is-machine-learning">What is machine learning?</a></li>
<li><a href="#what-is-image-classification">What is image classification?</a></li>
<li><a href="#deep-learning-workflow">Deep Learning Workflow</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-image-data.html">2. Introduction to Image Data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-build-cnn.html">3. Build a Convolutional Neural Network</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-fit-cnn.html">4. Compile and Train (Fit) a Convolutional Neural Network</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-evaluate-predict-cnn.html">5. Evaluate a Convolutional Neural Network and Make Predictions (Classifications)</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-share-cnn-next-steps.html">6. Share a Convolutional Neural Network and Next Steps</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="02-image-data.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="02-image-data.html" rel="next">
          Next: Introduction to...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Introduction to Deep Learning</h1>
        <p>Last updated on 2024-05-30 |

        <a href="https://github.com/erinmgraham/icwithcnn/edit/main/episodes/01-introduction.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What is machine learning and what is it used for?</li>
<li>What is deep learning?</li>
<li>How do I use a neural network for image classification?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Explain the difference between artificial intelligence, machine
learning and deep learning.</li>
<li>Understand the different types of computer vision tasks.</li>
<li>Perform an image classification using a convolutional neural network
(CNN).</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="deep-learning-machine-learning-and-artificial-intelligence">Deep Learning, Machine Learning and Artificial Intelligence<a class="anchor" aria-label="anchor" href="#deep-learning-machine-learning-and-artificial-intelligence"></a></h2>
<hr class="half-width"><p>Artificial Intelligence (AI) is the broad field that involves
creating machines capable of performing tasks that typically require
human intelligence. This includes everything from recognizing speech and
images to making decisions and translating languages. Within AI, Machine
Learning (ML) is a subset focused on the development of algorithms that
allow computers to learn and improve from experience without being
explicitly programmed.</p>
<p>Deep Learning (DL), a further subset of ML, utilizes neural networks
with many layers (hence “deep”) to model complex patterns in large
amounts of data. This technique has led to significant advances in
various fields, such as image and speech recognition.</p>
<p>Since the 1950s, the idea of AI has captured the imagination of many,
often depicted in science fiction as machines with human-like or even
superior intelligence. While recent advancements in AI and ML have been
remarkable, we are currently capable of achieving human-like
intelligence only in specific areas. The goal of creating a
general-purpose AI, one that can perform any intellectual task a human
can, remains a long-term challenge.</p>
<p>The image below illustrates some differences between artificial
intelligence, machine learning and deep learning.</p>
<figure><img src="fig/01_AI_ML_DL_differences.png" alt="Three nested circles defining deep learning as a subset of machine learning which is a subset of artifical intelligence" class="figure mx-auto d-block"><div class="figcaption">The image above is by Tukijaaliwa, CC BY-SA 4.0,
via Wikimedia Commons, <a href="https://en.wikipedia.org/wiki/File:AI-ML-DL.svg" class="external-link">original
source</a>
</div>
</figure></section><section><h2 class="section-heading" id="what-is-machine-learning">What is machine learning?<a class="anchor" aria-label="anchor" href="#what-is-machine-learning"></a></h2>
<hr class="half-width"><p>Machine learning is a set of tools and techniques which let us find
patterns in data. The techniques break down into two broad categories,
predictors and classifiers. Predictors are used to predict a value (or
set of values) given a set of inputs whereas classifiers try to classify
data into different categories, or assign a label.</p>
<p>Many, but not all, machine learning systems “learn” by taking a
series of input data and output data and using it to form a model. The
maths behind the machine learning doesn’t care what the data is as long
as it can represented numerically or categorised. Some examples might
include:</p>
<ul><li>Predicting a person’s weight based on their height.</li>
<li>Predicting house prices given stock market prices.</li>
<li>Classifying an email as spam or not.</li>
<li>Classifying an image as, e.g., a person, place, or particular
object.</li>
</ul><p>Typically we train our models with hundreds, thousands or even
millions of examples before they work well enough to do any useful
predictions or classifications with them.</p>
<p>This lesson will introduce you to only one of these techniques,
<strong>Deep Learning</strong> with <strong>Convolutional Neural
Network</strong>, abbreviated as <strong>CNN</strong>, but there are
many more.</p>
<p>A CNN is a DL algorithm that has become a cornerstone in image
classification due to its ability to automatically learn features from
images in a hierarchical fashion (i.e. each layer builds upon what was
learned by the previous layer). It can achieve remarkable performance on
a wide range of tasks.</p>
</section><section><h2 class="section-heading" id="what-is-image-classification">What is image classification?<a class="anchor" aria-label="anchor" href="#what-is-image-classification"></a></h2>
<hr class="half-width"><p>Image classification is a fundamental task in computer vision, which
is a field of artificial intelligence focused on teaching computers to
interpret and understand visual information from the world. Image
classification specifically involves the process of assigning a label or
category to an input image. The goal is to enable computers to recognise
and categorise objects, scenes, or patterns within images, just as a
human would. Image classification can refer to one of several computer
vision tasks:</p>
<figure><img src="fig/01_Fei-Fei_Li_Justin_Johnson_Serena_Young__CS231N_2017.png" alt="Four types of image classification tasks include semantic segmentation to label every pixel; classification and localisation to detect a single object like a cat; object detection to detect multiple objects like cats and dogs; and instance segmentation to detect each pixel of multiple objects" class="figure mx-auto d-block"><div class="figcaption">The image above is by Li, Johnson, &amp; Yeung,
Stanford University CS231n: Deep Learning for Computer Vision,
2017</div>
</figure><p>Image classification has numerous practical applications,
including:</p>
<ul><li>
<strong>Object Recognition</strong>: Identifying objects within
images, such as cars, animals, or household items.</li>
<li>
<strong>Medical Imaging</strong>: Diagnosing diseases from medical
images like X-rays or MRIs.</li>
<li>
<strong>Quality Control</strong>: Inspecting products for defects on
manufacturing lines.</li>
<li>
<strong>Autonomous Vehicles</strong>: Identifying pedestrians,
traffic signs, and other vehicles in self-driving cars.</li>
<li>
<strong>Security and Surveillance</strong>: Detecting anomalies or
unauthorised objects in security footage.</li>
</ul></section><section><h2 class="section-heading" id="deep-learning-workflow">Deep Learning Workflow<a class="anchor" aria-label="anchor" href="#deep-learning-workflow"></a></h2>
<hr class="half-width"><p>To apply Deep Learning to a problem there are several steps to go
through:</p>
<div class="section level3">
<h3 id="step-1--formulate-outline-the-problem">Step 1. Formulate / Outline the problem<a class="anchor" aria-label="anchor" href="#step-1--formulate-outline-the-problem"></a></h3>
<p>Firstly we must decide what it is we want our Deep Learning system to
do. This lesson is all about image classification so our aim is to put
an image into one of a few categories. Specifically in our case, we have
10 categories: airplane, automobile, bird, cat, deer, dog, frog, horse,
ship, truck</p>
</div>
<div class="section level3">
<h3 id="step-2--identify-inputs-and-outputs">Step 2. Identify inputs and outputs<a class="anchor" aria-label="anchor" href="#step-2--identify-inputs-and-outputs"></a></h3>
<p>Next identify what the inputs and outputs of the neural network will
be. In our case, the data is images and the inputs could be the
individual pixels of the images. We are performing a classification
problem and we will have one output for each potential class.</p>
</div>
<div class="section level3">
<h3 id="step-3--prepare-data">Step 3. Prepare data<a class="anchor" aria-label="anchor" href="#step-3--prepare-data"></a></h3>
<p>Many datasets are not ready for immediate use in a neural network and
will require some preparation. Neural networks can only really deal with
numerical data, so any non-numerical data (e.g., images) will have to be
somehow converted to numerical data. Information on how this is done and
the data structure will be explored in <a href="02-image-data">Episode
02 Introduction to Image Data</a>.</p>
<p>For this lesson, we will use an existing image dataset known as <a href="https://www.cs.toronto.edu/~kriz/cifar.html" class="external-link">CIFAR-10</a>
(Canadian Institute for Advanced Research). We will introduce the
different data preparation tasks in more detail in the next episode but
for this introduction, we will prepare the datset with these steps:</p>
<ul><li>normalise the image pixel values to be between 0 and 1</li>
<li>one-hot encode the training image labels</li>
<li>divide the data into <strong>training</strong>,
<strong>validation</strong>, and <strong>test</strong> subsets</li>
</ul><div class="section level4">
<h4 id="preparing-the-code">Preparing the code<a class="anchor" aria-label="anchor" href="#preparing-the-code"></a></h4>
<p>It is the goal of this training workshop to produce a Deep Learning
program, using a Convolutional Neural Network. At the end of this
workshop, we hope this code can be used as a “starting point”. We will
create an “initial program” for this introduction chapter that will be
used as a foundation for the rest of the episodes.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Here’s one we prepared earlier!</p>
<p>To follow along in Spyder, <a href="https://carpentries-incubator.github.io/intro-image-classification-cnn/#set-the-working-directory" class="external-link">Set
the working directory</a> to the
‘…/intro-image-classification-cnn/scripts’ folder where ‘…’ is your
project folder.</p>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># load the required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras <span class="co"># for neural networks </span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split <span class="co"># for splitting data into sets</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt <span class="co"># for plotting</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co"># create a function to prepare the training dataset</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="kw">def</span> prepare_dataset(train_images, train_labels):</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    </span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="co"># normalize the RGB values to be between 0 and 1</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    train_images <span class="op">=</span> train_images <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    </span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    <span class="co"># one hot encode the training labels</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>    train_labels <span class="op">=</span> keras.utils.to_categorical(train_labels, <span class="bu">len</span>(class_names))</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>    </span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    <span class="co"># split the training data into training and validation set</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>    train_images, val_images, train_labels, val_labels <span class="op">=</span> train_test_split(</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    train_images, train_labels, test_size <span class="op">=</span> <span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>    <span class="cf">return</span> train_images, val_images, train_labels, val_labels</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>(train_images, train_labels), (test_images, test_labels) <span class="op">=</span> keras.datasets.cifar10.load_data()</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="co"># create a list of class names associated with each CIFAR-10 label</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>class_names <span class="op">=</span> [<span class="st">'airplane'</span>, <span class="st">'automobile'</span>, <span class="st">'bird'</span>, <span class="st">'cat'</span>, <span class="st">'deer'</span>, <span class="st">'dog'</span>, <span class="st">'frog'</span>, <span class="st">'horse'</span>, <span class="st">'ship'</span>, <span class="st">'truck'</span>]</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="co">### Step 3. Prepare data</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="co"># prepare the dataset for training</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>train_images, val_images, train_labels, val_labels <span class="op">=</span> prepare_dataset(train_images, train_labels)</span></code></pre>
</div>
<div id="challenge-examine-the-cifar-10-dataset" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-examine-the-cifar-10-dataset" class="callout-inner">
<h3 class="callout-title">CHALLENGE Examine the CIFAR-10 dataset</h3>
<div class="callout-content">
<p>Explain the output of these commands?</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train: Images=</span><span class="sc">%s</span><span class="st">, Labels=</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> (train_images.shape, train_labels.shape))</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Validate: Images=</span><span class="sc">%s</span><span class="st">, Labels=</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> (val_images.shape, val_labels.shape))</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test: Images=</span><span class="sc">%s</span><span class="st">, Labels=</span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> (test_images.shape, test_labels.shape))</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Output
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Train: Images=(40000, 32, 32, 3), Labels=(40000, 10)
Validate: Images=(10000, 32, 32, 3), Labels=(10000, 10)
Test: Images=(10000, 32, 32, 3), Labels=(10000, 1)</code></pre>
</div>
<p>The training set consists of 40000 images of 32x32 pixels and three
channels (RGB values) and one-hot encoded labels.</p>
<p>The validation set consist of 10000 images of 32x32 pixels and three
channels (RGB values) and one-hot encoded labels.</p>
<p>The test set consists of 10000 images of 32x32 pixels and three
channels (RGB values) and labels.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="visualise-a-subset-of-the-cifar-10-dataset">Visualise a subset of the CIFAR-10 dataset<a class="anchor" aria-label="anchor" href="#visualise-a-subset-of-the-cifar-10-dataset"></a></h4>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># set up plot region, including width, height in inches</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">5</span>, ncols<span class="op">=</span><span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># add images to plot</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="cf">for</span> i,ax <span class="kw">in</span> <span class="bu">enumerate</span>(axes.flat):</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    ax.imshow(train_images[i])</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    ax.axis(<span class="st">'off'</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    ax.set_title(class_names[train_labels[i,].argmax()])</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    </span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co"># view plot</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<figure><img src="fig/01_cifar10_plot_subset.png" alt="Subset of 25 CIFAR-10 images representing different object classes" class="figure mx-auto d-block"></figure></div>
</div>
<div class="section level3">
<h3 id="step-4--choose-a-pre-trained-model-or-build-a-new-architecture-from-scratch">Step 4. Choose a pre-trained model or build a new architecture from
scratch<a class="anchor" aria-label="anchor" href="#step-4--choose-a-pre-trained-model-or-build-a-new-architecture-from-scratch"></a></h3>
<p>Often we can use an existing neural network instead of designing one
from scratch. Training a network can take a lot of time and
computational resources. There are a number of well publicised networks
which have been demonstrated to perform well at certain tasks. If you
know of one which already does a similar task well, then it makes sense
to use one of these.</p>
<p>If instead we decide to design our own network, then we need to think
about how many input neurons it will have, how many hidden layers and
how many outputs, and what types of layers to use. This will require
some experimentation and tweaking of the network design a few times
before achieving acceptable results.</p>
<p>Here we present an initial model to be explained in detail later
on:</p>
<div class="section level4">
<h4 id="define-the-model">Define the Model<a class="anchor" aria-label="anchor" href="#define-the-model"></a></h4>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="kw">def</span> create_model_intro():</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="co"># CNN Part 1</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="co"># Input layer of 32x32 images with three channels (RGB)</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    inputs_intro <span class="op">=</span> keras.Input(shape<span class="op">=</span>train_images.shape[<span class="dv">1</span>:])</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    </span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="co"># CNN Part 2</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    <span class="co"># Convolutional layer with 16 filters, 3x3 kernel size, and ReLU activation</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Conv2D(filters<span class="op">=</span><span class="dv">16</span>, kernel_size<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>)(inputs_intro)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    <span class="co"># Pooling layer with input window sized 2x2</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>))(x_intro)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>    <span class="co"># Second Convolutional layer with 32 filters, 3x3 kernel size, and ReLU activation</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Conv2D(filters<span class="op">=</span><span class="dv">32</span>, kernel_size<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>)(x_intro)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>    <span class="co"># Second Pooling layer with input window sized 2x2</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.MaxPooling2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>))(x_intro)</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>    <span class="co"># Flatten layer to convert 2D feature maps into a 1D vector</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Flatten()(x_intro)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>    <span class="co"># Dense layer with 64 neurons and ReLU activation</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>    x_intro <span class="op">=</span> keras.layers.Dense(units<span class="op">=</span><span class="dv">64</span>, activation<span class="op">=</span><span class="st">'relu'</span>)(x_intro)</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>    </span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>    <span class="co"># CNN Part 3</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>    <span class="co"># Output layer with 10 units (one for each class) and softmax activation</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>    outputs_intro <span class="op">=</span> keras.layers.Dense(units<span class="op">=</span><span class="dv">10</span>, activation<span class="op">=</span><span class="st">'softmax'</span>)(x_intro)</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>    </span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>    <span class="co"># create the model</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>    model_intro <span class="op">=</span> keras.Model(inputs <span class="op">=</span> inputs_intro, </span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>                              outputs <span class="op">=</span> outputs_intro, </span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>                              name <span class="op">=</span> <span class="st">"cifar_model_intro"</span>)</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>    </span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>    <span class="cf">return</span> model_intro</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="co"># create the introduction model</span></span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a>model_intro <span class="op">=</span> create_model_intro()</span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="co"># view model summary</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a>model_intro.summary()</span></code></pre>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-5--choose-a-loss-function-and-optimizer-and-compile-model">Step 5. Choose a loss function and optimizer and compile model<a class="anchor" aria-label="anchor" href="#step-5--choose-a-loss-function-and-optimizer-and-compile-model"></a></h3>
<p>To set up a model for training we need to compile it. This is when
you set up the rules and strategies for how your network is going to
learn.</p>
<p>The loss function tells the training algorithm how far away the
predicted value was from the true value. We will learn how to choose a
loss function in more detail in <a href="04-fit-cnn.html">Episode 4
Compile and Train (Fit) a Convolutional Neural Network</a>.</p>
<p>The optimizer is responsible for taking the output of the loss
function and then applying some changes to the weights within the
network. It is through this process that “learning” (adjustment of the
weights) is achieved.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># compile the model</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>model_intro.<span class="bu">compile</span>(optimizer <span class="op">=</span> keras.optimizers.Adam(),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                    loss <span class="op">=</span> keras.losses.CategoricalCrossentropy(),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                    metrics <span class="op">=</span> keras.metrics.CategoricalAccuracy())</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="step-6--train-the-model">Step 6. Train the model<a class="anchor" aria-label="anchor" href="#step-6--train-the-model"></a></h3>
<p>We can now go ahead and start training our neural network. We will
probably keep doing this for a given number of iterations through our
training dataset (referred to as epochs) or until the loss function
gives a value under a certain threshold.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>history_intro <span class="op">=</span> model_intro.fit(x <span class="op">=</span> train_images, y <span class="op">=</span> train_labels,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                                batch_size <span class="op">=</span> <span class="dv">32</span>,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                                epochs <span class="op">=</span> <span class="dv">10</span>, </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                                validation_data <span class="op">=</span> (val_images, val_labels))</span></code></pre>
</div>
<p>Your output will begin to print similar to the output below:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Epoch 1/10

1250/1250 [==============================] - 15s 12ms/step - loss: 1.4651 - accuracy: 0.4738 - val_loss: 1.2736 - val_accuracy: 0.5507</code></pre>
</div>
<div class="section level4">
<h4 id="what-does-this-output-mean">What does this output mean?<a class="anchor" aria-label="anchor" href="#what-does-this-output-mean"></a></h4>
<p>This output printed during the fit phase, i.e. training the model
against known image labels, can be broken down as follows:</p>
<ul><li>
<code>Epoch</code> describes the number of full passes over all
<em>training data</em>.</li>
<li>`In the output above, there are <strong>1250</strong> batches
(steps) to complete each epoch.
<ul><li>This number is calculated as the total number of images used as
input divided by the batch size (40000/32). After 1250 batches, all
training images will have been seen once and the model moves on to the
next epoch.</li>
</ul></li>
<li>
<code>loss</code> is a value the model will attempt to minimise and
is a measure of the dissimilarity or error between the true label of an
image and the model prediction. Minimising this distance is where
<em>learning</em> occurs to adjust weights and bias which reduce
<code>loss</code>.</li>
<li>
<code>val_loss</code> is a value calculated against the validation
data and is a measure of the model’s performance against unseen data.
<ul><li>Both values are a summation of errors made during each epoch.</li>
</ul></li>
<li>
<code>accuracy</code> and <code>val_accuracy</code> values are a
percentage and are only revelant to <strong>classification
problems</strong>.
<ul><li>The <code>val_accuracy</code> score can be used to communicate a
model’s effectiveness on unseen data.</li>
</ul></li>
</ul></div>
</div>
<div class="section level3">
<h3 id="step-7--perform-a-predictionclassification">Step 7. Perform a Prediction/Classification<a class="anchor" aria-label="anchor" href="#step-7--perform-a-predictionclassification"></a></h3>
<p>After training the network we can use it to perform predictions. This
is how you would use the network after you have fully trained it to a
satisfactory performance. The predictions performed here on a special
hold-out set is used in the next step to measure the performance of the
network. Make sure the images you use to test are prepared the same way
as the training images.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># normalize test dataset RGB values to be between 0 and 1</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>test_images <span class="op">=</span> test_images <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># make prediction for the first test image</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>result_intro <span class="op">=</span> model_intro.predict(test_images[<span class="dv">0</span>].reshape(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">3</span>))</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="bu">print</span>(result_intro)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co"># extract class with highest probability</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="bu">print</span>(class_names[result_intro.argmax()])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>1/1 [==============================] - 0s 93ms/step
[[0.00896197 0.00345764 0.20091638 0.3295959 0.3042777 0.03966621 0.06654432 0.00352677 0.03928733 0.00376582]]
cat</code></pre>
</div>
<p>Congratulations, you just created your first image classification
model and used it to classify an image!</p>
<p>Was the classification correct?</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># plot the first test image with its true label</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co"># create a plot</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>plt.figure()</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co"># display image</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>plt.imshow(test_images[<span class="dv">0</span>])</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>plt.title(<span class="st">'True class:'</span> <span class="op">+</span> class_names[result_intro.argmax()])</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co"># view plot</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>plt.show() </span></code></pre>
</div>
<figure><img src="fig/01_test_image.png" alt="poor resolution image of a cat" class="figure mx-auto d-block"></figure><div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>My result is different! Why? What can I do about?</p>
<p>This is actually not surprising. The architecture we are using is
shallow and the model only trained for 10 epochs.</p>
<p>Training a model for more epochs (longer time) and using a deeper
model (more layers) usually helps it learn better and give more accurate
predictions. When a model has learned well and its performance doesn’t
change much with more training, we say it has ‘converged.’
<strong>Convergence</strong> refers to the point where the model has
reached an optimal or near-optimal state in terms of learning from the
training data. If you are finding significant differences in the model
predictions, this could be a sign the model is not fully converged.</p>
<p>You may even find you get a different answer if you run this model
again. Although the neural network itself is deterministic (ie without
randomness), various factors in the training process, system setup, and
hardware configurations can lead to small variations in the output.
These variations are usually minor and should not significantly impact
the overall performance of the model, <em>if it has fully
converged</em>.</p>
<p>There are many ways to try to improve the accuracy of our model, such
as adding or removing layers to the model definition and fine-tuning the
hyperparameters, which takes us to the next steps in our workflow.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="step-8--measure-performance">Step 8. Measure Performance<a class="anchor" aria-label="anchor" href="#step-8--measure-performance"></a></h3>
<p>Once we trained the network we want to measure its performance. To do
this, we use additional data that was <strong>not</strong> part of the
training, called a test dataset. There are many different methods
available for measuring performance and which one is best depends on the
type of task we are attempting. These metrics are often published as an
indication of how well our network performs.</p>
</div>
<div class="section level3">
<h3 id="step-9--tune-hyperparameters">Step 9. Tune Hyperparameters<a class="anchor" aria-label="anchor" href="#step-9--tune-hyperparameters"></a></h3>
<p>When building image recognition models in Python, especially using
libraries like TensorFlow or Keras, the process involves not only
designing a neural network but also choosing the best values for various
hyperparameters that govern the training process.</p>
<p><strong>Hyperparameters</strong> are all the parameters set by the
person configuring the model as opposed to those learned by the
algorithm itself. These hyperparameters can include the learning rate,
the number of layers in the network, the number of neurons per layer,
and many more. Hyperparameter tuning refers to the process of
systematically searching for the best combination of hyperparameters
that will optimise the model’s performance. This concept will be
continued, with practical examples, in <a href="05-evaluate-predict-cnn.html">Episode 05 Evaluate a Convolutional
Neural Network and Make Predictions (Classifications)</a>.</p>
</div>
<div class="section level3">
<h3 id="step-10--share-model">Step 10. Share Model<a class="anchor" aria-label="anchor" href="#step-10--share-model"></a></h3>
<p>Once we have a trained network that performs at a level we are happy
with we can use it to predict on real-world data. At this point we might
want to consider publishing a file with both the architecture of our
network and the weights which it has learned (assuming we did not use a
pre-trained network). This will allow others to use it as as pre-trained
network for their own purposes and for them to (mostly) reproduce our
result.</p>
<p>To share the model we must save it first:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># save  model</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>model_intro.save(<span class="st">'fit_outputs/model_intro.keras'</span>)</span></code></pre>
</div>
<p>We will return to each of these workflow steps throughout this lesson
and discuss each component in more detail.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Machine learning is the process where computers learn to recognise
patterns of data.</li>
<li>Deep learning is a subset of machine learning, which is a subset of
artificial intelligence.</li>
<li>Convolutional neural networks are well suited for image
classification.</li>
<li>To use Deep Learning effectively we follow a workflow of: defining
the problem, identifying inputs and outputs, preparing data, choosing
the type of network, training the model, tuning hyperparameters, and
measuring performance before we can classify data.</li>
</ul></div>
</div>
</div>
<!-- Collect your link references at the bottom of your document -->
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="02-image-data.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="02-image-data.html" rel="next">
          Next: Introduction to...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/erinmgraham/icwithcnn/edit/main/episodes/01-introduction.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/erinmgraham/icwithcnn/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/erinmgraham/icwithcnn/" class="external-link">Source</a></p>
				<p><a href="https://github.com/erinmgraham/icwithcnn/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:erin.graham@jcu.edu.au">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.7" class="external-link">pegboard (0.7.7)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://erinmgraham.github.io/icwithcnn/01-introduction.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Introduction to Deep Learning",
  "creativeWorkStatus": "active",
  "url": "https://erinmgraham.github.io/icwithcnn/01-introduction.html",
  "identifier": "https://erinmgraham.github.io/icwithcnn/01-introduction.html",
  "dateCreated": "2023-05-03",
  "dateModified": "2024-05-30",
  "datePublished": "2025-01-28"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

